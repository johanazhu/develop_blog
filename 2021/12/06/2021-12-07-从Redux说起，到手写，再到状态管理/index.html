<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="azhubabyçš„æŠ€æœ¯åšå®¢"><title>ä» Redux è¯´èµ·ï¼Œåˆ°æ‰‹å†™ï¼Œå†åˆ°çŠ¶æ€ç®¡ç† | Azhubaby Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.2"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/latest/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/grids-responsive-min.min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/latest/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script src="https://www.googletagmanager.com/gtag/js?id=G-3Q5NWFLRS6" async></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-3Q5NWFLRS6');
</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement('script');
  hm.src = 'https://hm.baidu.com/hm.js?' + 'b735438e944e58cd4b0914986a8f821c';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();</script><script>(function(c,l,a,r,i,t,y){
    c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
    t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
    y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
})(window, document, "clarity", "script", "i1ldktvgdr");
</script><script type="text/javascript" src="//lib.baomitu.com/clipboard.js/latest/clipboard.min.js"></script><script type="text/javascript" src="//lib.baomitu.com/toastr.js/latest/toastr.min.js"></script><link rel="stylesheet" href="//lib.baomitu.com/toastr.js/latest/toastr.min.css"><div class="darkmode-toggle">ğŸŒ“</div><script>var prefersDarkMode = window.matchMedia('(prefers-color-scheme: dark)');
var toggle = document.querySelector('.darkmode-toggle');
var html = document.querySelector('html');

html.dataset.dark = localStorage.dark || prefersDarkMode.matches;

toggle.addEventListener('click', () => {
localStorage.dark = !(html.dataset.dark == 'true');
html.dataset.dark = localStorage.dark;
});</script><meta name="generator" content="Hexo 5.4.2"></head><body><header class="clearfix" id="header"><div class="container"><div class="col-group"><div class="site-name"><h1 class="hidden">ä» Redux è¯´èµ·ï¼Œåˆ°æ‰‹å†™ï¼Œå†åˆ°çŠ¶æ€ç®¡ç†</h1><a id="logo" href="/.">Azhubaby Blog</a><p class="description">å…³äºç¼–ç¨‹ã€ä¸ªäººæˆé•¿ä»¥åŠæ€è€ƒ</p></div><div> <nav class="clearfix" id="nav-menu"><a class="current" href="/."><i class="fa undefined"> é¦–é¡µ</i></a><a href="/archives/"><i class="fa undefined"> å½’æ¡£</i></a><a href="/tags/"><i class="fa undefined"> æ ‡ç­¾</i></a><a href="/about/"><i class="fa undefined"> å…³äº</i></a><a class="search-icon" href="javascript:void(0)"><i class="fa fa-search"></i></a></nav></div></div></div></header><div id="body"><div class="container"><div class="col-group"><div class="col-8" id="main"><div class="res-cons"><div class="post"><h1 class="post-title">ä» Redux è¯´èµ·ï¼Œåˆ°æ‰‹å†™ï¼Œå†åˆ°çŠ¶æ€ç®¡ç†</h1><div class="post-meta">2021-12-06<span> | </span><span class="category"><a href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/">å‰ç«¯å¼€å‘</a><!--busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js--><a href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/React/">React</a><!--busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js--></span><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> é˜…è¯»</span></span><span> | </span><span>ä½œè€…ï¼š</span><span class="author">å¸ç‹å¼•æ“</span></div><div class="post-content"><blockquote>
<p>å­¦ä¹ ä¸€ä¸ªä¸œè¥¿ä¹‹å‰ï¼Œé¦–å…ˆåœ¨å¤§è„‘ä¸­ç§¯ç´¯å……åˆ†çš„â€œç–‘æƒ‘æ„Ÿâ€ã€‚å³å¼„æ¸…é¢ä¸´çš„é—®é¢˜åˆ°åº•æ˜¯ä»€ä¹ˆï¼Œå†æµè§ˆæ–¹æ³•æœ¬èº«ä¹‹å‰ï¼Œæœ€å¥½å…ˆä½¿åŠ²é—®é—®éƒ½æƒ³åˆ°ä»€ä¹ˆæ–¹æ³•ã€‚ä¸€ä¸ªå…¬è®¤çš„äº‹å®æ˜¯ï¼Œä½ å¯¹é—®é¢˜çš„ç–‘æƒ‘è¶Šå¤§ï¼Œåœ¨ä¹‹å‰åšçš„è‡ªå·±çš„æ€è€ƒè¶Šå¤šï¼Œå½“çœ‹åˆ°è§£ç­”ä¹‹åå°è±¡å°±è¶Šæ·±åˆ»</p>
</blockquote>
<h2 id="å…ˆè¯´ç»“è®º"><a href="#å…ˆè¯´ç»“è®º" class="headerlink" title="å…ˆè¯´ç»“è®º"></a>å…ˆè¯´ç»“è®º</h2><ol>
<li>Redux æ˜¯çŠ¶æ€ç®¡ç†åº“ï¼Œä¹Ÿæ˜¯ä¸€ç§æ¶æ„</li>
<li>Redux ä¸ React æ— å…³ï¼Œä½†å®ƒæ˜¯ä¸ºäº†è§£å†³ React ç»„ä»¶ä¸­çŠ¶æ€æ— æ³•å…±äº«è€Œå‡ºçš„ä¸€ç§è§£å†³æ–¹æ¡ˆ</li>
<li>å•çº¯çš„ Redux åªæ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼Œ store ä¸­å­˜æ”¾äº†æ‰€æœ‰çš„çŠ¶æ€ stateï¼Œè¦æƒ³æ”¹å˜é‡Œé¢çš„çŠ¶æ€ stateï¼Œåªèƒ½ dispatch ä¸€ä¸ªåŠ¨ä½œ</li>
<li>å‘å‡ºå»çš„ action éœ€è¦ç”¨ reducer æ¥å¤„ç†ï¼Œä¼ å…¥ state å’Œ actionï¼Œè¿”å›æ–°çš„ state</li>
<li>subscribe æ–¹æ³•å¯ä»¥æ³¨å†Œå›è°ƒæ–¹æ³•ï¼Œå½“ dispatch action çš„æ—¶å€™ä¼šæ‰§è¡Œé‡Œé¢çš„å›è°ƒ</li>
<li>Redux å…¶å®æ˜¯ä¸€ä¸ªå‘å¸ƒè®¢é˜…æ¨¡å¼</li>
<li>Redux æ”¯æŒ enhancerï¼Œenhancer å…¶å®å°±æ˜¯ä¸€ä¸ªè£…é¥°å™¨æ¨¡å¼ï¼Œä¼ å…¥å½“å‰çš„ createStoreï¼Œè¿”å›ä¸€ä¸ªå¢å¼ºçš„ createStore</li>
<li>Redux ä½¿ç”¨ applyMiddleware å‡½æ•°æ”¯æŒä¸­é—´ä»¶ï¼Œå®ƒçš„è¿”å›å€¼å…¶å®å°±æ˜¯ä¸€ä¸ª enhancer</li>
<li>Redux çš„ä¸­é—´ä»¶ä¹Ÿæ˜¯ä¸€ä¸ªè£…é¥°å™¨æ¨¡å¼ï¼Œä¼ å…¥å½“å‰çš„ dispatchï¼Œè¿”å›ä¸€ä¸ªå¢å¼ºäº†çš„ dispatch</li>
<li>å•çº¯çš„ Redux æ˜¯æ²¡æœ‰ View å±‚çš„</li>
</ol>
<h2 id="ä¸ºä»€ä¹ˆå‡ºç°-Reduxï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆå‡ºç°-Reduxï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆå‡ºç° Reduxï¼Ÿ"></a>ä¸ºä»€ä¹ˆå‡ºç° Reduxï¼Ÿ</h2><p>æˆ‘ä»¬é»˜è®¤ä½¿ç”¨ React æŠ€æœ¯æ ˆï¼Œå½“é¡µé¢å°‘ä¸”ç®€å•æ—¶ï¼Œå®Œå…¨æ²¡å¿…è¦ä½¿ç”¨ Reduxã€‚Redux çš„å‡ºç°ï¼Œæ˜¯ä¸ºäº†åº”å¯¹å¤æ‚ç»„ä»¶çš„æƒ…å†µã€‚å³å½“ç»„ä»¶å¤æ‚åˆ°ä¸‰å±‚ç”šè‡³å››å±‚æ—¶ï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼Œç»„ä»¶ 4 æƒ³æ”¹å˜ç»„ä»¶ 1 çš„çŠ¶æ€</p>
<p><img src="https://i.loli.net/2021/12/01/HruEAivF4DsxNcq.png" alt="react ç»„ä»¶æ ‘"></p>
<p>æŒ‰ç…§ React çš„åšæ³•ï¼ŒçŠ¶æ€æå‡ï¼Œå°†çŠ¶æ€æå‡è‡³åŒä¸€çˆ¶ç»„ä»¶ï¼ˆåœ¨å›¾ä¸­ä¸ºç¥–çˆ¶ç»„ä»¶ï¼‰ã€‚ä½†å±‚çº§ä¸€å¤šï¼Œæ ¹ç»„ä»¶è¦ç®¡ç†çš„ state å°±å¾ˆå¤šäº†ï¼Œä¸æ–¹ä¾¿ç®¡ç†ã€‚</p>
<p>æ‰€ä»¥å½“åˆæœ‰äº† contextï¼ˆReact 0.14 ç¡®å®šå¼•å…¥ï¼‰ï¼Œé€šè¿‡ context èƒ½å®ç°â€è¿œæˆ¿ç»„ä»¶â€œçš„æ•°æ®å…±äº«ã€‚ä½†å®ƒä¹Ÿæœ‰ç¼ºç‚¹ï¼Œä½¿ç”¨ context æ„å‘³ç€æ‰€æœ‰çš„ç»„ä»¶éƒ½å¯ä»¥ä¿®æ”¹ context é‡Œé¢çš„çŠ¶æ€ï¼Œå°±åƒè°éƒ½å¯ä»¥ä¿®æ”¹å…±äº«çŠ¶æ€ä¸€æ ·ï¼Œå¯¼è‡´ç¨‹åºè¿è¡Œçš„ä¸å¯é¢„æµ‹ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„</p>
<p>facebook æå‡ºäº† <a target="_blank" rel="noopener" href="https://facebook.github.io/flux/">Flux</a> è§£å†³æ–¹æ¡ˆï¼Œå®ƒå¼•å…¥äº†<a href="#%E8%A1%A5%E5%85%85%EF%BC%9A%E5%8D%95%E5%90%91%E6%95%B0%E6%8D%AE%E6%B5%81">å•å‘æ•°æ®æµ</a>çš„æ¦‚å¿µï¼ˆæ²¡é”™ï¼ŒReact æ²¡æœ‰å•å‘æ•°æ®æµçš„æ¦‚å¿µï¼ŒRedux æ˜¯é›†æˆäº† Flux çš„å•å‘æ•°æ®æµç†å¿µï¼‰ï¼Œæ¶æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2021/12/01/YzWmMoJCILsVZaE.png" alt="Flux æµç¨‹å›¾"></p>
<p>è¿™é‡Œä¸è¡¨ Fluxã€‚ç®€å•ç†è§£ï¼Œåœ¨ Flux æ¶æ„ä¸­ï¼ŒView è¦é€šè¿‡ Action ï¼ˆåŠ¨ä½œï¼‰é€šçŸ¥ Dispatcherï¼ˆæ´¾å‘å™¨ï¼‰ï¼ŒDispatcher æ¥ä¿®æ”¹ Storeï¼ŒStore å†ä¿®æ”¹ View</p>
<p>Flux çš„é—®é¢˜æˆ–è€…è¯´ç¼ºç‚¹åœ¨å“ªï¼Ÿ</p>
<p>store ä¹‹é—´å­˜åœ¨ä¾èµ–å…³ç³»ã€éš¾ä»¥è¿›è¡ŒæœåŠ¡å™¨ç«¯æ¸²æŸ“ã€ stores æ··æ‚äº†é€»è¾‘å’ŒçŠ¶æ€</p>
<p>ç¬”è€…åœ¨å­¦ä¹ çš„ React æŠ€æœ¯æ ˆæ—¶æ˜¯ 2018 å¹´ï¼Œé‚£æ˜¯å·²ç„¶æµè¡Œ React + Redux çš„è§£å†³æ–¹æ¡ˆï¼ŒFlux å·²ç»è¢«æ·˜æ±°äº†ï¼Œäº†è§£ Flux æ˜¯ä¸ºäº†å¼•å‡º Redux</p>
<h2 id="Redux-çš„å‡ºç°"><a href="#Redux-çš„å‡ºç°" class="headerlink" title="Redux çš„å‡ºç°"></a>Redux çš„å‡ºç°</h2><p>Redux ä¸»è¦è§£å†³çŠ¶æ€å…±äº«é—®é¢˜</p>
<blockquote>
<p>å®˜ç½‘ï¼šRedux æ˜¯ JavaScript çŠ¶æ€å®¹å™¨ï¼Œå®ƒæä¾›å¯é¢„æµ‹çš„çŠ¶æ€ç®¡ç†</p>
<p>å®ƒçš„ä½œè€…æ˜¯ <a target="_blank" rel="noopener" href="https://overreacted.io/">Dan Abramov</a></p>
</blockquote>
<p>å…¶æ¶æ„ä¸ºï¼š</p>
<p><img src="https://i.loli.net/2021/12/02/eFszAQYxwLNMKUt.png" alt="Redux æµç¨‹å›¾"></p>
<p>å¯ä»¥çœ‹å¾—å‡ºï¼ŒRedux åªæ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼Œæ²¡æœ‰ View å±‚ã€‚å…¶è¿‡ç¨‹å¯ä»¥è¿™æ ·æè¿°ï¼š</p>
<ul>
<li>è‡ªå·±å†™ä¸€ä¸ª reducerï¼ˆçº¯å‡½æ•°ï¼Œè¡¨ç¤ºåšä»€ä¹ˆåŠ¨ä½œä¼šè¿”å›ä»€ä¹ˆæ•°æ®ï¼‰</li>
<li>è‡ªå·±å†™ä¸€ä¸ª initStateï¼ˆstore åˆå§‹å€¼ï¼Œå¯å†™å¯ä¸å†™ï¼‰</li>
<li>é€šè¿‡ createStore ç”Ÿæˆ storeï¼Œæ­¤å˜é‡åŒ…å«äº†ä¸‰ä¸ªé‡è¦çš„å±æ€§<ul>
<li>store.getStateï¼šå¾—åˆ°å”¯ä¸€å€¼ï¼ˆä½¿ç”¨äº†é—­åŒ…è€å“¥ï¼‰</li>
<li>store.dispatchï¼šåŠ¨ä½œè¡Œä¸ºï¼ˆæ”¹å˜ store ä¸­æ•°æ®çš„å”¯ä¸€æŒ‡å®šå±æ€§ï¼‰</li>
<li>store.subscribeï¼šè®¢é˜…ï¼ˆå‘å¸ƒè®¢é˜…æ¨¡å¼ï¼‰</li>
</ul>
</li>
<li>é€šè¿‡ store.dispatch æ´¾å‘ä¸€ä¸ª action</li>
<li>reducer å¤„ç† action è¿”å›ä¸€ä¸ªæ–°çš„ store</li>
<li>å¦‚æœä½ è®¢é˜…è¿‡ï¼Œå½“æ•°æ®æ”¹å˜æ—¶ï¼Œä½ ä¼šæ”¶åˆ°é€šçŸ¥</li>
</ul>
<p>æŒ‰ç…§è¡Œä¸ºè¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯æ‰‹å†™ä¸€ä¸ª Reduxï¼Œä¸‹æ–‡åœ¨è¡¨ï¼Œå…ˆè¯´ç‰¹ç‚¹</p>
<h3 id="ä¸‰å¤§åŸåˆ™"><a href="#ä¸‰å¤§åŸåˆ™" class="headerlink" title="ä¸‰å¤§åŸåˆ™"></a>ä¸‰å¤§åŸåˆ™</h3><ul>
<li>å•ä¸€æ•°æ®æº<ul>
<li>æ•´ä¸ªåº”ç”¨çš„ å…¨å±€ state è¢«å‚¨å­˜åœ¨ä¸€æ£µ object tree ä¸­ï¼Œå¹¶ä¸”è¿™ä¸ª object tree åªå­˜åœ¨äºå”¯ä¸€ä¸€ä¸ª store ä¸­</li>
</ul>
</li>
<li>State æ˜¯åªè¯»çš„<ul>
<li>å”¯ä¸€æ”¹å˜ state çš„æ–¹æ³•å°±æ˜¯è§¦å‘ actionï¼Œaction æ˜¯ä¸€ä¸ªç”¨äºæè¿°å·²å‘ç”Ÿæ—¶é—´çš„æ™®é€šå¯¹è±¡</li>
</ul>
</li>
<li>ä½¿ç”¨çº¯å‡½æ•°æ¥æ‰§è¡Œä¿®æ”¹<ul>
<li>ä¸ºäº†æè¿° action å¦‚ä½•æ”¹å˜ state treeï¼Œä½ éœ€è¦ç¼–å†™çº¯çš„ reducers</li>
</ul>
</li>
</ul>
<p>ä¸‰å¤§åŸåˆ™æ˜¯ä¸ºäº†æ›´å¥½åœ°å¼€å‘ï¼ŒæŒ‰ç…§<a href="#%E8%A1%A5%E5%85%85%EF%BC%9A%E5%8D%95%E5%90%91%E6%95%B0%E6%8D%AE%E6%B5%81">å•å‘æ•°æ®æµ</a>çš„ç†å¿µï¼Œè¡Œä¸ºå˜å¾—å¯å›æº¯</p>
<p>è®©æˆ‘ä»¬åŠ¨æ‰‹å†™ä¸€ä¸ª Redux å§</p>
<h2 id="æ‰‹å†™-redux"><a href="#æ‰‹å†™-redux" class="headerlink" title="æ‰‹å†™ redux"></a>æ‰‹å†™ redux</h2><p>æŒ‰ç…§è¡Œä¸ºè¿‡ç¨‹å’ŒåŸåˆ™ï¼Œæˆ‘ä»¬è¦é¿å…æ•°æ®çš„éšæ„ä¿®æ”¹ã€è¡Œä¸ºçš„å¯å›æº¯ç­‰é—®é¢˜</p>
<h3 id="åŸºç¡€ç‰ˆï¼š23-è¡Œä»£ç è®©ä½ ä½¿ç”¨-redux"><a href="#åŸºç¡€ç‰ˆï¼š23-è¡Œä»£ç è®©ä½ ä½¿ç”¨-redux" class="headerlink" title="åŸºç¡€ç‰ˆï¼š23 è¡Œä»£ç è®©ä½ ä½¿ç”¨ redux"></a>åŸºç¡€ç‰ˆï¼š23 è¡Œä»£ç è®©ä½ ä½¿ç”¨ redux</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">createStore</span> = (<span class="params">reducer, initState</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> state = initState;</span><br><span class="line">  <span class="keyword">let</span> listeners = [];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">subscribe</span> = (<span class="params">fn</span>) =&gt; &#123;</span><br><span class="line">    listeners.<span class="title function_">push</span>(fn);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">dispatch</span> = (<span class="params">action</span>) =&gt; &#123;</span><br><span class="line">    state = <span class="title function_">reducer</span>(state, action);</span><br><span class="line">    listeners.<span class="title function_">forEach</span>(<span class="function">(<span class="params">fn</span>) =&gt;</span> <span class="title function_">fn</span>());</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">getState</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> state;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    getState,</span><br><span class="line">    dispatch,</span><br><span class="line">    subscribe,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>æä¸ªæµ‹è¯•ç”¨ä¾‹</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">&#x27;../redux/index.js&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> initState = &#123;</span><br><span class="line">  <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">reducer</span> = (<span class="params">state, action</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;INCREMENT&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        ...state,</span><br><span class="line">        <span class="attr">count</span>: state.<span class="property">count</span> + <span class="number">1</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;DECREMENT&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        ...state,</span><br><span class="line">        <span class="attr">count</span>: state.<span class="property">count</span> - <span class="number">1</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(reducer, initState);</span><br><span class="line"></span><br><span class="line">store.<span class="title function_">subscribe</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> state = store.<span class="title function_">getState</span>();</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;state&#x27;</span>, state);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">store.<span class="title function_">dispatch</span>(&#123;</span><br><span class="line">  <span class="attr">type</span>: <span class="string">&#x27;INCREMENT&#x27;</span>,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>PSï¼šä¿ºæ˜¯åœ¨ node ä¸­ä½¿ç”¨ ES6 æ¨¡å—ï¼Œéœ€è¦å‡çº§ Node ç‰ˆæœ¬è‡³ 13.2.0</p>
</blockquote>
<h3 id="ç¬¬äºŒç‰ˆï¼šéš¾ç‚¹çªç ´ï¼šä¸­é—´ä»¶"><a href="#ç¬¬äºŒç‰ˆï¼šéš¾ç‚¹çªç ´ï¼šä¸­é—´ä»¶" class="headerlink" title="ç¬¬äºŒç‰ˆï¼šéš¾ç‚¹çªç ´ï¼šä¸­é—´ä»¶"></a>ç¬¬äºŒç‰ˆï¼šéš¾ç‚¹çªç ´ï¼šä¸­é—´ä»¶</h3><p>æ™®é€šçš„ Redux åªèƒ½åšæœ€åŸºç¡€åœ°æ ¹æ®åŠ¨ä½œè¿”å›æ•°æ®ï¼Œdispatch åªæ˜¯ä¸€ä¸ªå–æ•°æ®çš„å‘½ä»¤ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">dispatch</span>(&#123;</span><br><span class="line">  <span class="attr">type</span>: <span class="string">&#x27;INCREMENT&#x27;</span>,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// store ä¸­çš„ count + 1</span></span><br></pre></td></tr></table></figure>

<p>ä½†åœ¨å¼€å‘ä¸­ï¼Œæˆ‘ä»¬æœ‰æ—¶å€™è¦æŸ¥çœ‹æ—¥å¿—ã€å¼‚æ­¥è°ƒç”¨ã€è®°å½•æ—¥å¸¸ç­‰</p>
<p>æ€ä¹ˆåŠï¼Œåšæˆæ’ä»¶</p>
<p>åœ¨ Redux ä¸­ï¼Œç±»ä¼¼çš„æ¦‚å¿µå«ä¸­é—´ä»¶</p>
<p><img src="https://i.loli.net/2021/12/03/xqXD5ynSbl6MWVu.png" alt="ä¸­é—´ä»¶"></p>
<p>Redux çš„ createStore å…±æœ‰ä¸‰ä¸ªå‚æ•°</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">createStore</span>([reducer], [initial state], [enhancer]);</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸‰ä¸ªå‚æ•°ä¸º enhancerï¼Œæ„ä¸ºå¢å¼ºå™¨ã€‚å®ƒçš„ä½œç”¨å°±æ˜¯ä»£æ›¿æ™®é€šçš„ createStoreï¼Œè½¬å˜æˆä¸ºé™„åŠ ä¸Šä¸­é—´ä»¶çš„ createStoreã€‚æ‰“å‡ ä¸ªæ¯”æ–¹ï¼š</p>
<ul>
<li>æ‰˜å°¼Â·æ–¯å¡”å…‹æœ¬æ¥æ˜¯ä¸€ä¸ªæ™®é€šæœ‰é’±äººï¼ŒåŠ ä¸Šå¢å¼ºå™¨ï¼ˆç›”ç”²ï¼‰åï¼Œæˆäº†é’¢é“ä¾ </li>
<li>ä¸­å¤®ä¸‹å‘ä¸€ç¬”æ•‘ç¾æ¬¾ï¼ŒåŠ ä¸Šå¢å¼ºå™¨ï¼ˆå¤§å°å®˜å‘˜çš„æ‰“ç‚¹ï¼‰åï¼Œåˆ°ç¾æ°‘æ‰‹ä¸Šçš„é’±åªæœ‰ä¸€ä¸¢ä¸¢</li>
<li>è·¯é£ç”¨æ­¦è£…è‰²æ‰“äººï¼Œæ­¦è£…è‰²å°±æ˜¯ä¸€ä¸ªä¸­é—´ä»¶</li>
</ul>
<p>enhancer è¦åšçš„å°±æ˜¯ï¼š<strong>ä¸œè¥¿è¿˜æ˜¯é‚£ä¸ªä¸œè¥¿ï¼Œåªæ˜¯ç»è¿‡äº†ä¸€äº›å·¥åºï¼ŒåŠ å¼ºäº†å®ƒ</strong>ã€‚è¿™äº›å·¥åºç”± applyMiddleware å‡½æ•°å®Œæˆã€‚æŒ‰ç…§è¡Œä¸šæœ¯è¯­ï¼Œå®ƒæ˜¯ä¸€ä¸ª<strong>è£…é¥°å™¨æ¨¡å¼</strong>ã€‚å®ƒçš„å†™æ³•å¤§è‡´æ˜¯ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">applyMiddleware</span>(...middlewares);</span><br><span class="line"><span class="comment">// ç»“åˆ createStoreï¼Œå°±æ˜¯</span></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(reudcer, initState, <span class="title function_">applyMiddleware</span>(...middlewares));</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦å…ˆå¯¹ createStore è¿›è¡Œæ”¹é€ ï¼Œåˆ¤æ–­å½“æœ‰ enhancer æ—¶ï¼Œæˆ‘ä»¬éœ€ä¼ å€¼ç»™ä¸­é—´ä»¶</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">createStore</span> = (<span class="params">reducer, initState, enhancer</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (enhancer) &#123;</span><br><span class="line">        <span class="keyword">const</span> newCreateStore = <span class="title function_">enhancer</span>(createStore)</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">newCreateStore</span>(reducer, initState)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">let</span> state = initState;</span><br><span class="line">    <span class="keyword">let</span> listeners = [];</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæœ‰ enhancer çš„è¯ï¼Œå…ˆä¼ å…¥ createStore å‡½æ•°ï¼Œç”Ÿæˆçš„ newCreateStore å’ŒåŸæ¥çš„ createStore ä¸€æ ·ï¼Œä¼šæ ¹æ® reducer, initState ç”Ÿæˆ storeã€‚å¯ç®€åŒ–ä¸ºï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (enhancer) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">enhancer</span>(createStore)(reducer, initState);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>PSï¼šä¸ºä»€ä¹ˆè¦å†™æˆè¿™æ ·ï¼Œå› ä¸º redux æ˜¯æŒ‰ç…§å‡½æ•°å¼å†™æ³•æ¥å†™çš„</p>
<p>ä¸ºä»€ä¹ˆ createStore å¯ä»¥è¢«ä¼ å€¼ï¼Œå› ä¸ºå‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ï¼ˆè€é“é—­åŒ…äº†ï¼‰</p>
</blockquote>
<p>è¿™æ ·æˆ‘ä»¬çš„ applyMiddleware è‡ªç„¶å°±æ˜ç¡®äº†</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">applyMiddleware</span> = (<span class="params">...middlewares</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">oldCreateStore</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function">(<span class="params">reducer, initState</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> store = <span class="title function_">oldCreateStore</span>(reducer, initState)</span><br><span class="line">            ...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œçš„ store è¡¨ç¤ºçš„æ˜¯æ™®é€šç‰ˆä¸­çš„ storeï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¦å¢å¼º store ä¸­çš„å±æ€§</p>
<p>æˆ‘æ„¿ç§°ä¹‹ä¸ºï¼šäº”è¡Œä»£ç è®©å¥³äººä¸ºæˆ‘èŠ±äº† 18 ä¸‡</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">applyMiddleware</span> = (<span class="params">...middlewares</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">oldCreateStore</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">reducer, initState</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> store = <span class="title function_">oldCreateStore</span>(reducer, initState);</span><br><span class="line">      <span class="comment">// ä»¥ä¸‹ä¸ºæ–°å¢</span></span><br><span class="line">      <span class="keyword">const</span> chain = middlewares.<span class="title function_">map</span>(<span class="function">(<span class="params">middleware</span>) =&gt;</span> <span class="title function_">middleware</span>(store));</span><br><span class="line">      <span class="comment">// è·å¾—è€ dispatch</span></span><br><span class="line">      <span class="keyword">let</span> dispatch = store.<span class="property">dispatch</span>;</span><br><span class="line">      chain.<span class="title function_">reverse</span>().<span class="title function_">map</span>(<span class="function">(<span class="params">middleware</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// ç»™æ¯ä¸ªä¸­é—´ä»¶ä¼ å…¥åŸæ´¾å‘å™¨ï¼Œèµ‹å€¼ä¸­é—´ä»¶æ”¹é€ åçš„dispatch</span></span><br><span class="line">        dispatch = <span class="title function_">middleware</span>(dispatch);</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="comment">// èµ‹å€¼ç»™ store ä¸Šçš„ dispatch</span></span><br><span class="line">      store.<span class="property">dispatch</span> = dispatch;</span><br><span class="line">      <span class="keyword">return</span> store;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ç°åœ¨å†™å‡ ä¸ªä¸­é—´ä»¶æ¥æµ‹è¯•ä¸€ä¸‹</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®°å½•æ—¥å¿—</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">loggerMiddleware</span> = (<span class="params">store</span>) =&gt; <span class="function">(<span class="params">next</span>) =&gt;</span> <span class="function">(<span class="params">action</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;this.state&#x27;</span>, store.<span class="title function_">getState</span>());</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;action&#x27;</span>, action);</span><br><span class="line">  <span class="title function_">next</span>(action);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;next state&#x27;</span>, store.<span class="title function_">getState</span>());</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®°å½•å¼‚å¸¸</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">exceptionMiddleware</span> = (<span class="params">store</span>) =&gt; <span class="function">(<span class="params">next</span>) =&gt;</span> <span class="function">(<span class="params">action</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="title function_">next</span>(action);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;é”™è¯¯æŠ¥å‘Š&#x27;</span>, error);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ—¶é—´æˆ³</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">timeMiddleware</span> = (<span class="params">store</span>) =&gt; <span class="function">(<span class="params">next</span>) =&gt;</span> <span class="function">(<span class="params">action</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;time&#x27;</span>, <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>());</span><br><span class="line">  <span class="title function_">next</span>(action);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>å¼•å…¥é¡¹ç›®ä¸­ï¼Œå¹¶è¿è¡Œ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore, applyMiddleware &#125; <span class="keyword">from</span> <span class="string">&#x27;../redux/index.js&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  loggerMiddleware,</span><br><span class="line">  exceptionMiddleware,</span><br><span class="line">  timeMiddleware,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;./middleware.js&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> initState = &#123;</span><br><span class="line">  <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">reducer</span> = (<span class="params">state, action</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;INCREMENT&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        ...state,</span><br><span class="line">        <span class="attr">count</span>: state.<span class="property">count</span> + <span class="number">1</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;DECREMENT&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        ...state,</span><br><span class="line">        <span class="attr">count</span>: state.<span class="property">count</span> - <span class="number">1</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(</span><br><span class="line">  reducer,</span><br><span class="line">  initState,</span><br><span class="line">  <span class="title function_">applyMiddleware</span>(loggerMiddleware, exceptionMiddleware, timeMiddleware),</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">store.<span class="title function_">subscribe</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> state = store.<span class="title function_">getState</span>();</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;state&#x27;</span>, state);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">store.<span class="title function_">dispatch</span>(&#123;</span><br><span class="line">  <span class="attr">type</span>: <span class="string">&#x27;INCREMENT&#x27;</span>,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œå‘ç°å·²ç»å®ç°äº† redux æœ€é‡è¦çš„åŠŸèƒ½â€”â€”ä¸­é—´ä»¶</p>
<p><img src="https://i.loli.net/2021/12/03/F6l5Gfdow9OUSTn.png" alt="æµ‹è¯•ä»£ç "></p>
<p>æ¥åˆ†æä¸‹ä¸­é—´ä»¶çš„å‡½æ•°å¼ç¼–ç¨‹ï¼Œä»¥ loggerMiddleware ä¸ºä¾‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">loggerMiddleware</span> = (<span class="params">store</span>) =&gt; <span class="function">(<span class="params">next</span>) =&gt;</span> <span class="function">(<span class="params">action</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;this.state&#x27;</span>, store.<span class="title function_">getState</span>());</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;action&#x27;</span>, action);</span><br><span class="line">  <span class="title function_">next</span>(action);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;next state&#x27;</span>, store.<span class="title function_">getState</span>());</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>åœ¨ applyMiddleware æºç ä¸­ï¼Œ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> chain = middlewares.<span class="title function_">map</span>(<span class="function">(<span class="params">middleware</span>) =&gt;</span> <span class="title function_">middleware</span>(store));</span><br></pre></td></tr></table></figure>

<p>ç›¸å½“äºç»™æ¯ä¸ªä¸­é—´ä»¶ä¼ å€¼æ™®é€šç‰ˆçš„ store</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> dispatch = store.<span class="property">dispatch</span>;</span><br><span class="line">chain.<span class="title function_">reverse</span>().<span class="title function_">map</span>(<span class="function">(<span class="params">middleware</span>) =&gt;</span> (dispatch = <span class="title function_">middleware</span>(dispatch)));</span><br></pre></td></tr></table></figure>

<p>ç›¸å½“äºç»™æ¯ä¸ªä¸­é—´ä»¶åœ¨ä¼ å…¥ store.dispatchï¼Œä¹Ÿå°±æ˜¯ nextï¼Œ<strong>åŸ dispatch = next</strong>ã€‚è¿™ä¸ªæ—¶å€™çš„ä¸­é—´ä»¶å·²ç»æœ¬æˆå“äº†ï¼Œä»£ç ä¸­çš„ <code>(action) =&gt; &#123;...&#125;</code> å°±æ˜¯å‡½æ•° <code>const dispatch = (action) =&gt; &#123;&#125;</code>ã€‚å½“ä½ æ‰§è¡Œ <code>dispatch(&#123; type: XXX &#125;)</code> æ—¶æ‰§è¡Œä¸­é—´ä»¶è¿™æ®µ<code>(action) =&gt; &#123;...&#125;</code></p>
<blockquote>
<p>PSï¼šæŸ¯é‡ŒåŒ–ä¸€å¼€å§‹æ¯”è¾ƒéš¾ç†è§£ï¼Œç”¨å¤šä¹ æƒ¯å°±æ…¢æ…¢èƒ½æ‡‚</p>
</blockquote>
<h3 id="ç¬¬ä¸‰ç‰ˆï¼šç»“æ„å¤æ‚åŒ–ä¸æ‹†åˆ†"><a href="#ç¬¬ä¸‰ç‰ˆï¼šç»“æ„å¤æ‚åŒ–ä¸æ‹†åˆ†" class="headerlink" title="ç¬¬ä¸‰ç‰ˆï¼šç»“æ„å¤æ‚åŒ–ä¸æ‹†åˆ†"></a>ç¬¬ä¸‰ç‰ˆï¼šç»“æ„å¤æ‚åŒ–ä¸æ‹†åˆ†</h3><p>ä¸­é—´ä»¶ç†è§£èµ·æ¥æˆ–è®¸æœ‰äº›å¤æ‚ï¼Œå…ˆçœ‹çœ‹å…¶ä»–çš„æ¦‚å¿µæ¢æ¢æ€è·¯</p>
<p>ä¸€ä¸ªåº”ç”¨åšå¤§åï¼Œå•é ä¸€ä¸ª JavaScript æ–‡ä»¶æ¥ç»´æŠ¤ä»£ç æ˜¾ç„¶æ˜¯ä¸ç§‘å­¦çš„ï¼Œåœ¨ Redux ä¸­ï¼Œä¸ºé¿å…è¿™ç±»æƒ…å†µï¼Œå®ƒæä¾›äº† <code>combineReducers</code> æ¥æ•´ä¸ªå¤šä¸ª reducerï¼Œä½¿ç”¨æ–¹æ³•å¦‚ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> reducer = <span class="title function_">combinReducers</span>(&#123;</span><br><span class="line">  <span class="attr">counter</span>: counterReducer,</span><br><span class="line">  <span class="attr">info</span>: infoReducer,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>åœ¨ <code>combinReducers</code> ä¸­ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œä»€ä¹ˆæ ·çš„ state å¯¹åº”ä»€ä¹ˆæ ·çš„ reducerã€‚è¿™å°±å¥½äº†ï¼Œé‚£ä¹ˆ <code>combinReducers</code> æ€ä¹ˆå®ç°å‘¢ï¼Ÿå› ä¸ºæ¯”è¾ƒç®€å•ï¼Œä¸åšå¤šåˆ†æï¼Œç›´æ¥ä¸Šæºç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">combinReducers</span> = (<span class="params">...reducers</span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// æ‹¿åˆ° counterã€info</span></span><br><span class="line">  <span class="keyword">const</span> reducerKey = <span class="title class_">Object</span>.<span class="title function_">keys</span>(reducers);</span><br><span class="line">  <span class="comment">// combinReducers åˆå¹¶çš„æ˜¯ reducerï¼Œè¿”å›çš„è¿˜æ˜¯ä¸€ä¸ª reducerï¼Œæ‰€ä»¥è¿”å›ä¸€æ ·çš„ä¼ å‚</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">state = &#123;&#125;, action</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> nextState = &#123;&#125;;</span><br><span class="line">    <span class="comment">// å¾ªç¯ reducerKeyï¼Œä»€ä¹ˆæ ·çš„ state å¯¹åº”ä»€ä¹ˆæ ·çš„ reducer</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; reducerKey.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">const</span> key = reducerKey[i];</span><br><span class="line">      <span class="keyword">const</span> reducer = reducers[key];</span><br><span class="line">      <span class="keyword">const</span> previousStateForKey = state[key];</span><br><span class="line">      <span class="keyword">const</span> nextStateForKey = <span class="title function_">reducer</span>(previousStateForKey, action);</span><br><span class="line">      nextState[key] = nextStateForKey;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> nextState;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>åŒçº§ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª reducer æ–‡ä»¶å¤¹ï¼Œå¹¶æ–°å»º <code>reducer.js</code>ã€<code>info.js</code>ã€<code>index.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// reducer.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (state, action) =&gt; &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;INCREMENT&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">count</span>: state.<span class="property">count</span> + <span class="number">1</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;DECREMENT&#x27;</span>: &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">count</span>: state.<span class="property">count</span> - <span class="number">1</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// info.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (state, action) =&gt; &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;SET_NAME&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        ...state,</span><br><span class="line">        <span class="attr">name</span>: action.<span class="property">name</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;SET_DESCRIPTION&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        ...state,</span><br><span class="line">        <span class="attr">description</span>: action.<span class="property">description</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>åˆå¹¶å¯¼å‡º</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> counterReducer <span class="keyword">from</span> <span class="string">&#x27;./counter.js&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> infoReducer <span class="keyword">from</span> <span class="string">&#x27;./info.js&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; counterReducer, infoReducer &#125;;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬ç°åœ¨æµ‹è¯•ä¸€ä¸‹</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  createStore,</span><br><span class="line">  applyMiddleware,</span><br><span class="line">  combinReducers,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;../redux/index.js&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  loggerMiddleware,</span><br><span class="line">  exceptionMiddleware,</span><br><span class="line">  timeMiddleware,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;./middleware.js&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; counterReducer, infoReducer &#125; <span class="keyword">from</span> <span class="string">&#x27;./reducer/index.js&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> initState = &#123;</span><br><span class="line">  <span class="attr">counter</span>: &#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">info</span>: &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;johan&#x27;</span>,</span><br><span class="line">    <span class="attr">description</span>: <span class="string">&#x27;å‰ç«¯ä¹‹è™&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> reducer = <span class="title function_">combinReducers</span>(&#123;</span><br><span class="line">  <span class="attr">counter</span>: counterReducer,</span><br><span class="line">  <span class="attr">info</span>: infoReducer,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(</span><br><span class="line">  reducer,</span><br><span class="line">  initState,</span><br><span class="line">  <span class="title function_">applyMiddleware</span>(loggerMiddleware, exceptionMiddleware, timeMiddleware),</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">store.<span class="title function_">dispatch</span>(&#123;</span><br><span class="line">  <span class="attr">type</span>: <span class="string">&#x27;INCREMENT&#x27;</span>,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><code>combinReducers</code> ä¹Ÿå®Œæˆäº†</p>
<p><img src="https://i.loli.net/2021/12/03/afUen16QiKRy3l4.png" alt="æµ‹è¯•ä»£ç "></p>
<p>æ—¢ç„¶æ‹†åˆ†äº† reducerï¼Œé‚£ä¹ˆ state æ˜¯å¦ä¹Ÿèƒ½æ‹†åˆ†ï¼Œå¹¶ä¸”å®ƒæ˜¯å¦éœ€è¦ä¼ ï¼Œåœ¨æˆ‘ä»¬å¹³æ—¶çš„å†™æ³•ä¸­ï¼Œä¸€èˆ¬éƒ½ä¸ä¼  stateã€‚è¿™é‡Œéœ€è¦ä¸¤ç‚¹æ”¹é€ ï¼Œä¸€æ˜¯æ¯ä¸ª reducer ä¸­åŒ…å«äº†å®ƒçš„ state å’Œ reducerï¼›äºŒæ˜¯æ”¹é€  createStoreï¼Œè®© initState å˜å¾—å¯ä¼ å¯ä¸ä¼ ï¼Œä»¥åŠåˆå§‹åŒ–æ•°æ®</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// counter.js ä¸­å†™å…¥å¯¹åº”çš„ state å’Œ reducer</span></span><br><span class="line"><span class="keyword">let</span> initState = &#123;</span><br><span class="line">  <span class="attr">counter</span>: &#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (state, action) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (!state) &#123;</span><br><span class="line">    state = initState;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;INCREMENT&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">count</span>: state.<span class="property">count</span> + <span class="number">1</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;DECREMENT&#x27;</span>: &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">count</span>: state.<span class="property">count</span> - <span class="number">1</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// info.js</span></span><br><span class="line"><span class="keyword">let</span> initState = &#123;</span><br><span class="line">  <span class="attr">info</span>: &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;johan&#x27;</span>,</span><br><span class="line">    <span class="attr">description</span>: <span class="string">&#x27;å‰ç«¯ä¹‹è™&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (state, action) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (!state) &#123;</span><br><span class="line">    state = initState;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;SET_NAME&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        ...state,</span><br><span class="line">        <span class="attr">name</span>: action.<span class="property">name</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;SET_DESCRIPTION&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        ...state,</span><br><span class="line">        <span class="attr">description</span>: action.<span class="property">description</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>æ”¹é€  createStore</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">createStore</span> = (<span class="params">reducer, initState, enhancer</span>) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> initState === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">        enhancer = initState;</span><br><span class="line">        initState = <span class="literal">undefined</span></span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">getState</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> state</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">// ç”¨ä¸€ä¸ªä¸åŒ¹é…ä»»ä½•åŠ¨ä½œæ¥åˆå§‹åŒ–store</span></span><br><span class="line">    <span class="title function_">dispatch</span>(&#123; <span class="attr">type</span>: <span class="title class_">Symbol</span>() &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        getState,</span><br><span class="line">        dispatch,</span><br><span class="line">        subscribe</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸»æ–‡ä»¶ä¸­</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore, applyMiddleware, combinReducers &#125; <span class="keyword">from</span> <span class="string">&#x27;./redux/index.js&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  loggerMiddleware,</span><br><span class="line">  exceptionMiddleware,</span><br><span class="line">  timeMiddleware,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;./middleware.js&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; counterReducer, infoReducer &#125; <span class="keyword">from</span> <span class="string">&#x27;./reducer/index.js&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> reducer = <span class="title function_">combinReducers</span>(&#123;</span><br><span class="line">  <span class="attr">counter</span>: counterReducer,</span><br><span class="line">  <span class="attr">info</span>: infoReducer,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(</span><br><span class="line">  reducer,</span><br><span class="line">  <span class="title function_">applyMiddleware</span>(loggerMiddleware, exceptionMiddleware, timeMiddleware),</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">dir</span>(store.<span class="title function_">getState</span>());</span><br></pre></td></tr></table></figure>

<p>åˆ°æ­¤ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»å®ç°äº†ä¸€ä¸ªä¸ƒä¸ƒå…«å…«çš„ redux äº†</p>
<h3 id="å®Œæ•´ä½“çš„-Redux"><a href="#å®Œæ•´ä½“çš„-Redux" class="headerlink" title="å®Œæ•´ä½“çš„ Redux"></a>å®Œæ•´ä½“çš„ Redux</h3><h4 id="é€€è®¢"><a href="#é€€è®¢" class="headerlink" title="é€€è®¢"></a>é€€è®¢</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">subscribe</span> = (<span class="params">fn</span>) =&gt; &#123;</span><br><span class="line">  listeners.<span class="title function_">push</span>(fn);</span><br><span class="line">  <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> index = listeners.<span class="title function_">indexOf</span>(listener);</span><br><span class="line">    listeners.<span class="title function_">splice</span>(index, <span class="number">1</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="ä¸­é—´ä»¶æ‹¿åˆ°çš„-store"><a href="#ä¸­é—´ä»¶æ‹¿åˆ°çš„-store" class="headerlink" title="ä¸­é—´ä»¶æ‹¿åˆ°çš„ store"></a>ä¸­é—´ä»¶æ‹¿åˆ°çš„ store</h4><p>ç°åœ¨çš„ä¸­é—´ä»¶èƒ½æ‹¿åˆ°å®Œæ•´çš„ storeï¼Œä»–ç”šè‡³å¯ä»¥ä¿®æ”¹æˆ‘ä»¬çš„ subscribe æ–¹æ³•ã€‚æŒ‰ç…§<strong>æœ€å°å¼€æ”¾ç­–ç•¥</strong>ï¼Œæˆ‘ä»¬åªç”¨ç»™ getState å³å¯ï¼Œä¿®æ”¹ä¸‹ applyMiddleware ä¸­ç»™ä¸­é—´ä»¶ä¼ çš„ store</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// const chain = middlewares.map(middleware =&gt; middleware(store))</span></span><br><span class="line"><span class="keyword">const</span> simpleStore = &#123; <span class="attr">getState</span>: store.<span class="property">getState</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> chain = middlewares.<span class="title function_">map</span>(<span class="function">(<span class="params">middleware</span>) =&gt;</span> <span class="title function_">middleware</span>(simpleStore));</span><br></pre></td></tr></table></figure>

<h4 id="compose"><a href="#compose" class="headerlink" title="compose"></a>compose</h4><p>åœ¨æˆ‘ä»¬çš„ applyMiddleware ä¸­ï¼ŒæŠŠ [A, B, C] è½¬æ¢æˆ A(B(C(next)))ï¼Œæ•ˆæœæ˜¯ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> chain = [A, B, C];</span><br><span class="line"><span class="keyword">let</span> dispatch = store.<span class="property">dispatch</span>;</span><br><span class="line">chain.<span class="title function_">reverse</span>().<span class="title function_">map</span>(<span class="function">(<span class="params">middleware</span>) =&gt;</span> &#123;</span><br><span class="line">  dispatch = <span class="title function_">middleware</span>(dispatch);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Redux æä¾›äº†ä¸€ä¸ª compose ï¼Œå¦‚ä¸‹</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">compose</span> = (<span class="params">...funcs</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (funcs.<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">args</span>) =&gt;</span> args;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (funcs.<span class="property">length</span> === <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> funcs[<span class="number">0</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> funcs.<span class="title function_">reduce</span>(</span><br><span class="line">    <span class="function">(<span class="params">a, b</span>) =&gt;</span></span><br><span class="line">      <span class="function">(<span class="params">...args</span>) =&gt;</span></span><br><span class="line">        <span class="title function_">a</span>(<span class="title function_">b</span>(...args)),</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="2-è¡Œä»£ç -replaceReducer"><a href="#2-è¡Œä»£ç -replaceReducer" class="headerlink" title="2 è¡Œä»£ç  replaceReducer"></a>2 è¡Œä»£ç  replaceReducer</h4><p>æ›¿æ¢å½“å‰çš„ reudcer ï¼Œä½¿ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>ä»£ç åˆ†å‰²</li>
<li>åŠ¨æ€åŠ è½½</li>
<li>å®æ—¶ reloading æœºåˆ¶</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">replaceReducer</span> = (<span class="params">nextReducer</span>) =&gt; &#123;</span><br><span class="line">  reducer = nextReducer;</span><br><span class="line">  <span class="comment">// åˆ·æ–°ä¸€æ¬¡ï¼Œå¹¿æ’­ reducer å·²ç»æ›¿æ¢ï¼Œä¹ŸåŒæ ·æŠŠé»˜è®¤å€¼æ¢æˆæ–°çš„ reducer</span></span><br><span class="line">  <span class="title function_">dispatch</span>(&#123; <span class="attr">type</span>: <span class="title class_">Symbol</span>() &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="bindActionCreators"><a href="#bindActionCreators" class="headerlink" title="bindActionCreators"></a>bindActionCreators</h4><p>bindActionCreators æ˜¯åšä»€ä¹ˆçš„ï¼Œä»–é€šè¿‡é—­åŒ…ï¼ŒæŠŠ dispatch å’Œ actionCreator éšè—èµ·æ¥ï¼Œè®©å…¶ä»–åœ°æ–¹æ„ŸçŸ¥ä¸åˆ° redux çš„å­˜åœ¨ã€‚ä¸€èˆ¬ä¸ react-redux çš„ connect ç»“åˆ</p>
<p>è¿™é‡Œç›´æ¥è´´æºç å®ç°ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">bindActionCreator</span> = (<span class="params">actionCreator, dispatch</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">dispatch</span>(actionCreator.<span class="title function_">apply</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>));</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">bindActionCreators</span> = (<span class="params">actionCreators, dispatch</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> actionCreators === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">bindActionCreator</span>(actionCreators, dispatch);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> actionCreators !== <span class="string">&#x27;object&#x27;</span> || actionCreators === <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> keys = <span class="title class_">Object</span>.<span class="title function_">keys</span>(actionCreators);</span><br><span class="line">  <span class="keyword">const</span> boundActionCreators = &#123;&#125;;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; keys.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">const</span> key = keys[i];</span><br><span class="line">    <span class="keyword">const</span> actionCreator = actionCreators[key];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> actionCreator === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">      boundActionCreators[key] = <span class="title function_">bindActionCreator</span>(actionCreator, dispatch);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> boundActionCreators;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šï¼Œæˆ‘ä»¬å°±å·²ç»å®Œæˆäº† Redux ä¸­æ‰€æœ‰çš„ä»£ç ã€‚å¤§ä½“ä¸Šè¿™é‡Œ 100 å¤šè¡Œçš„ä»£ç å°±æ˜¯ Redux çš„å…¨éƒ¨ï¼ŒçœŸ Redux æ— éæ˜¯åŠ äº†äº›æ³¨é‡Šå’Œå‚æ•°æ ¡éªŒ</p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>æˆ‘ä»¬æŠŠä¸ Redux ç›¸å…³çš„åè¯åˆ—å‡ºæ¥ï¼Œæ¢³ç†å®ƒæ˜¯åšä»€ä¹ˆçš„</p>
<ul>
<li>createStore<ul>
<li>åˆ›å»º store å¯¹è±¡ï¼ŒåŒ…å« getStateã€dispatchã€subscribeã€replaceReducer</li>
</ul>
</li>
<li>reducer<ul>
<li>çº¯å‡½æ•°ï¼Œæ¥å—æ—§çš„ stateã€actionï¼Œç”Ÿæˆæ–°çš„ state</li>
</ul>
</li>
<li>action<ul>
<li>åŠ¨ä½œï¼Œæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¿…é¡»åŒ…æ‹¬ type å­—æ®µï¼Œè¡¨ç¤º view å‘å‡ºé€šçŸ¥å‘Šè¯‰ store è¦æ”¹å˜</li>
</ul>
</li>
<li>dispatch<ul>
<li>æ´¾å‘ï¼Œè§¦å‘ action ï¼Œç”Ÿæˆæ–°çš„ stateã€‚æ˜¯ view å‘å‡º action çš„å”¯ä¸€æ–¹æ³•</li>
</ul>
</li>
<li>subscribe<ul>
<li>è®¢é˜…ï¼Œåªæœ‰è®¢é˜…äº†ï¼Œå½“æ´¾å‘æ—¶ï¼Œä¼šæ‰§è¡Œè®¢é˜…å‡½æ•°</li>
</ul>
</li>
<li>combineReducers<ul>
<li>åˆå¹¶ reducer æˆä¸€ä¸ª reducer</li>
</ul>
</li>
<li>replaceReudcer<ul>
<li>ä»£æ›¿ reducer çš„å‡½æ•°</li>
</ul>
</li>
<li>middleware<ul>
<li>ä¸­é—´ä»¶ï¼Œæ‰©å±• dispatch å‡½æ•°</li>
</ul>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://github.com/brickspert">ç –å®¶</a>æ›¾ç»ç”»è¿‡ä¸€å¼ å…³äº Redux çš„æµç¨‹å›¾</p>
<p><img src="https://s2.loli.net/2021/12/06/xD9omCG4OScBFiK.png" alt="æµç¨‹å›¾"></p>
<h2 id="æ¢ç§æ€è€ƒæ–¹å¼ç†è§£"><a href="#æ¢ç§æ€è€ƒæ–¹å¼ç†è§£" class="headerlink" title="æ¢ç§æ€è€ƒæ–¹å¼ç†è§£"></a>æ¢ç§æ€è€ƒæ–¹å¼ç†è§£</h2><p>æˆ‘ä»¬è¯´è¿‡ï¼Œ Redux åªæ˜¯ä¸€ä¸ªçŠ¶æ€ç®¡ç†åº“ï¼Œå®ƒæ˜¯ç”±æ•°æ®æ¥é©±åŠ¨ï¼Œå‘èµ· actionï¼Œä¼šå¼•å‘ reducer çš„æ•°æ®æ›´æ–°ï¼Œä»è€Œæ›´æ–°åˆ°æœ€æ–°çš„ store</p>
<h3 id="ä¸-React-ç»“åˆ"><a href="#ä¸-React-ç»“åˆ" class="headerlink" title="ä¸ React ç»“åˆ"></a>ä¸ React ç»“åˆ</h3><p>æ‹¿ç€åˆšåšå¥½çš„ Reduxï¼Œæ”¾åˆ° React ä¸­ï¼Œè¯•è¯•ä»€ä¹ˆå« Redux + React é›†åˆï¼Œæ³¨æ„ï¼Œè¿™é‡Œæˆ‘ä»¬å…ˆä¸ä½¿ç”¨ React-Reduxï¼Œå•æ‹¿è¿™ä¸¤ä¸ªç»“åˆ</p>
<p>å…ˆåˆ›å»ºé¡¹ç›®</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx create-react-app demo-5-react</span><br></pre></td></tr></table></figure>

<p>å¼•å…¥æ‰‹å†™çš„ redux åº“</p>
<p>åœ¨ <code>App.js</code> ä¸­å¼•å…¥ createStoreï¼Œå¹¶å†™å¥½åˆå§‹æ•°æ®å’Œ reducerï¼Œåœ¨ useEffect ä¸­ç›‘å¬æ•°æ®ï¼Œç›‘å¬å¥½ä¹‹åå½“å‘èµ·ä¸€ä¸ª action æ—¶ï¼Œæ•°æ®å°±ä¼šæ”¹å˜ï¼Œçœ‹ä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useEffect, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">&#x27;./redux&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./App.css&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> initState = &#123;</span><br><span class="line">  <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">reducer</span> = (<span class="params">state, action</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;INCREMENT&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        ...state,</span><br><span class="line">        <span class="attr">count</span>: state.<span class="property">count</span> + <span class="number">1</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;DECREMENT&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        ...state,</span><br><span class="line">        <span class="attr">count</span>: state.<span class="property">count</span> - <span class="number">1</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(reducer, initState);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(store.<span class="title function_">getState</span>().<span class="property">count</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> unsubscribe = store.<span class="title function_">subscribe</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">setCount</span>(store.<span class="title function_">getState</span>().<span class="property">count</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (unsubscribe) &#123;</span><br><span class="line">        <span class="title function_">unsubscribe</span>();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">onHandle</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    store.<span class="title function_">dispatch</span>(&#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&#x27;INCREMENT&#x27;</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;store&#x27;</span>, store.<span class="title function_">getState</span>().<span class="property">count</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;count&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;onHandle&#125;</span>&gt;</span>add<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>

<p>ç‚¹å‡» button åï¼Œæ•°æ®è·Ÿç€æ”¹å˜</p>
<p><img src="https://s2.loli.net/2021/12/06/E5xaY7dVv9OJUMP.png" alt="æ•ˆæœå›¾"></p>
<blockquote>
<p>PSï¼šè™½ç„¶æˆ‘ä»¬å¯ä»¥ç”¨è¿™ç§æ–¹å¼è®¢é˜… store å’Œæ”¹å˜æ•°æ®ï¼Œä½†æ˜¯è®¢é˜…çš„ä»£ç é‡å¤è¿‡å¤šï¼Œæˆ‘ä»¬å¯ä»¥ç”¨é«˜é˜¶ç»„ä»¶å°†ä»–æå–å‡ºå»ã€‚è¿™ä¹Ÿæ˜¯ React-Redux æ‰€åšçš„äº‹æƒ…</p>
</blockquote>
<h3 id="ä¸åŸç”Ÿ-JS-HTML-ç»“åˆ"><a href="#ä¸åŸç”Ÿ-JS-HTML-ç»“åˆ" class="headerlink" title="ä¸åŸç”Ÿ JS+HTML ç»“åˆ"></a>ä¸åŸç”Ÿ JS+HTML ç»“åˆ</h3><p>æˆ‘ä»¬è¯´è¿‡ï¼ŒRedux æ˜¯ä¸ªç‹¬ç«‹äº Redux çš„å­˜åœ¨ï¼Œå®ƒä¸ä»…å¯åœ¨ Redux å……å½“æ•°æ®ç®¡ç†å™¨ï¼Œè¿˜å¯ä»¥åœ¨åŸç”Ÿ JS + HTML ä¸­å……å½“èµ·èŒä½</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;count&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;btn&quot;</span>&gt;</span>add<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;module&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">&#x27;./redux/index.js&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> initState = &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">count</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> <span class="title function_">reducer</span> = (<span class="params">state, action</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">case</span> <span class="string">&#x27;INCREMENT&#x27;</span>:</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">              ...state,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">count</span>: state.<span class="property">count</span> + <span class="number">1</span>,</span></span><br><span class="line"><span class="language-javascript">            &#125;;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">case</span> <span class="string">&#x27;DECREMENT&#x27;</span>:</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">              ...state,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">count</span>: state.<span class="property">count</span> - <span class="number">1</span>,</span></span><br><span class="line"><span class="language-javascript">            &#125;;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">default</span>:</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> state;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> store = <span class="title function_">createStore</span>(reducer, initState);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> count = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;count&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> add = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;btn&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">      add.<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        store.<span class="title function_">dispatch</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">type</span>: <span class="string">&#x27;INCREMENT&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// æ¸²æŸ“è§†å›¾</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">function</span> <span class="title function_">render</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        count.<span class="property">innerHTML</span> = store.<span class="title function_">getState</span>().<span class="property">count</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">render</span>();</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// ç›‘å¬æ•°æ®</span></span></span><br><span class="line"><span class="language-javascript">      store.<span class="title function_">subscribe</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> state = store.<span class="title function_">getState</span>();</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;state&#x27;</span>, state);</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">render</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="https://s2.loli.net/2021/12/06/zuaQsI9mhj5SAPF.png" alt="æ•ˆæœå›¾"></p>
<h2 id="çŠ¶æ€ç”Ÿæ€"><a href="#çŠ¶æ€ç”Ÿæ€" class="headerlink" title="çŠ¶æ€ç”Ÿæ€"></a>çŠ¶æ€ç”Ÿæ€</h2><p>æˆ‘ä»¬ä» Flux è¯´åˆ° Reduxï¼Œå†ä» Redux è¯´äº†å„ç§ä¸­é—´ä»¶ï¼Œå…¶ä¸­ React-saga å°±æ˜¯ä¸ºè§£å†³å¼‚æ­¥è¡Œä¸ºè€Œç”Ÿçš„ä¸­é—´ä»¶ï¼Œå®ƒä¸»è¦é‡‡ç”¨ Generatorï¼ˆç”Ÿæˆå™¨ï¼‰æ¦‚å¿µï¼Œæ¯”èµ· React-thunk å’Œ React-promiseï¼Œå®ƒæ²¡æœ‰åƒå…¶ä»–ä¸¤è€…å°†å¼‚æ­¥è¡Œä¸ºæ”¾åœ¨ action creator ä¸Šï¼Œè€Œæ˜¯æŠŠæ‰€æœ‰çš„å¼‚æ­¥æ“ä½œçœ‹æˆâ€œçº¿ç¨‹â€ï¼Œé€šè¿‡ action è§¦å‘å®ƒï¼Œå½“æ“ä½œå®Œæˆåå†æ¬¡å‘å‡º action ä½œä¸ºè¾“å‡º</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">helloWorldGenerator</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="string">&#x27;world&#x27;</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="string">&#x27;ending&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> helloWorld = <span class="title function_">helloWorldGenerator</span>();</span><br><span class="line"></span><br><span class="line">hewlloWorld.<span class="title function_">next</span>(); <span class="comment">// &#123; value: &#x27;hello&#x27;, done: false &#125;</span></span><br><span class="line">hewlloWorld.<span class="title function_">next</span>(); <span class="comment">// &#123; value: &#x27;world&#x27;, done: false &#125;</span></span><br><span class="line">hewlloWorld.<span class="title function_">next</span>(); <span class="comment">// &#123; value: &#x27;ending&#x27;, done: true &#125;</span></span><br><span class="line">hewlloWorld.<span class="title function_">next</span>(); <span class="comment">// &#123; value: undefined, done: true &#125;</span></span><br></pre></td></tr></table></figure>

<p>ç®€å•æ¥è¯´ï¼šé‡åˆ° yield è¡¨è¾¾å¼ï¼Œå°±æš‚åœæ‰§è¡Œåé¢çš„æ“ä½œï¼Œå¹¶å°†ç´§è·Ÿ yield åé¢çš„é‚£ä¸ªè¡¨è¾¾å¼çš„å€¼ï¼Œä½œä¸ºè¿”å›å€¼ valueï¼Œç­‰ç€ä¸‹ä¸€ä¸ªè°ƒç”¨ next æ–¹æ³•ï¼Œå†ç»§ç»­å¾€ä¸‹æ‰§è¡Œ</p>
<h3 id="Dva"><a href="#Dva" class="headerlink" title="Dva"></a>Dva</h3><p>Dva æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<blockquote>
<p>å®˜ç½‘ï¼šDva é¦–å…ˆæ˜¯ä¸€ä¸ªåŸºäº Redux + Redux-saga çš„æ•°æ®æµæ–¹æ¡ˆã€‚ä¸ºäº†ç®€åŒ–å¼€å‘ä½“éªŒï¼ŒDva è¿˜é¢å¤–å†…ç½®äº† react-router å’Œ fetchï¼Œæ‰€ä»¥å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªè½»é‡çº§çš„åº”ç”¨æ¡†æ¶</p>
</blockquote>
<p>ç®€å•æ¥è¯´ï¼Œå®ƒæ˜¯æ•´åˆäº†ç°åœ¨æœ€æµè¡Œçš„æ•°æ®æµæ–¹æ¡ˆï¼Œå³ä¸€ä¸ª React æŠ€æœ¯æ ˆï¼š</p>
<p>dva = React-Router + Redux + Redux-saga + React-Redux</p>
<p>å®ƒçš„æ•°æ®æµå›¾ä¸ºï¼š</p>
<p><img src="https://s2.loli.net/2021/12/06/QUOfn9sW2NqEyCA.png" alt="Dva æµç¨‹å›¾"></p>
<p>view dispatch ä¸€ä¸ªåŠ¨ä½œï¼Œæ”¹å˜ stateï¼ˆå³ storeï¼‰ï¼Œstate ä¸ view ç»‘å®šï¼Œå“åº” view</p>
<p>å…¶ä»–ä¸è¡¨ï¼Œå¯å» <a target="_blank" rel="noopener" href="https://dvajs.com/">Dva å®˜ç½‘</a>æŸ¥çœ‹ï¼Œè¿™é‡Œè®²è®² Model ï¼Œå®ƒåŒ…å«äº† 5 ä¸ªå±æ€§</p>
<ul>
<li>namespace<ul>
<li>model çš„å‘½åç©ºé—´ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä»–åœ¨å…¨å±€ state ä¸Šçš„å±æ€§ï¼Œåªèƒ½ç”¨å­—ç¬¦ä¸²ï¼Œä¸æ”¯æŒé€šè¿‡ <code>.</code> çš„æ–¹å¼åˆ›å»ºå¤šå±‚å‘½åç©ºé—´</li>
</ul>
</li>
<li>state<ul>
<li>åˆå§‹å€¼</li>
</ul>
</li>
<li>reducers<ul>
<li>çº¯å‡½æ•°ï¼Œä»¥ key/value æ ¼å¼å®šä¹‰ reducerã€‚ç”¨äºå¤„ç†åŒæ­¥æ“¦åšï¼Œå”¯ä¸€å¯ä»¥ä¿®æ”¹ <code>state</code> çš„åœ°æ–¹ï¼Œç”± <code>action</code> è§¦å‘</li>
<li>æ ¼å¼ä¸ºï¼š<code>(state, action) =&gt; newState</code> æˆ– <code>[(state, action) =&gt; newState, enhancer]</code></li>
</ul>
</li>
<li>effects<ul>
<li>å¤„ç†å¼‚æ­¥æ“ä½œå’Œä¸šåŠ¡é€»è¾‘ï¼Œä»¥ key/value æ ¼å¼å®šä¹‰ effect</li>
<li>ä¸ç›´æ¥ä¿®æ”¹ stateã€‚ç”± action è§¦å‘</li>
<li>callï¼šæ‰§è¡Œå¼‚æ­¥æ“ä½œ</li>
<li>putï¼šå‘å‡ºä¸€ä¸ª Actionï¼Œç±»ä¼¼äº dispatch</li>
</ul>
</li>
<li>subscriptions<ul>
<li>è®¢é˜…</li>
<li>åœ¨ <code>app.start()</code> æ—¶è¢«æ‰§è¡Œï¼Œæ•°æ®æºå¯ä»¥æ˜¯å½“å‰çš„æ—¶é—´ã€æœåŠ¡å™¨çš„ websocket é“¾æ¥ã€ keyboard è¾“å…¥ã€history è·¯ç”±å˜åŒ–ã€geolocation å˜åŒ–ç­‰ç­‰</li>
</ul>
</li>
</ul>
<h3 id="Mobx"><a href="#Mobx" class="headerlink" title="Mobx"></a>Mobx</h3><p>View é€šè¿‡è®¢é˜…ä¹Ÿå¥½ï¼Œç›‘å¬ä¹Ÿå¥½ï¼Œä¸åŒçš„æ¡†æ¶æœ‰ä¸åŒçš„æŠ€æœ¯ï¼Œæ€»ä¹‹ store å˜åŒ–ï¼Œ view ä¹Ÿè·Ÿç€å˜åŒ–</p>
<p>Mobx ä½¿ç”¨çš„æ˜¯å“åº”å¼æ•°æ®æµæ–¹æ¡ˆã€‚åç»­ä¼šå•ç‹¬å†™ä¸€ç¯‡ï¼Œæ­¤ç¯‡å¤ªé•¿ï¼Œå…ˆä¸å†™</p>
<h2 id="è¡¥å……ï¼šå•å‘æ•°æ®æµ"><a href="#è¡¥å……ï¼šå•å‘æ•°æ®æµ" class="headerlink" title="è¡¥å……ï¼šå•å‘æ•°æ®æµ"></a>è¡¥å……ï¼šå•å‘æ•°æ®æµ</h2><p>å…ˆä»‹ç» React ä¸­æ•°æ®ä¼ é€’ï¼Œå³é€šä¿¡é—®é¢˜</p>
<ul>
<li>å‘å­ç»„ä»¶å‘æ¶ˆæ¯</li>
<li>å‘çˆ¶ç»„ä»¶å‘æ¶ˆæ¯</li>
<li>å‘å…¶ä»–ç»„ä»¶å‘æ¶ˆæ¯</li>
</ul>
<p>React åªæä¾›äº†ä¸€ç§é€šä¿¡æ–¹å¼ï¼šä¼ å‚ã€‚</p>
<p>å³çˆ¶ä¼ å€¼ç»™å­ï¼Œå­ä¸èƒ½ä¿®æ”¹çˆ¶ä¼ çš„æ•°æ®ï¼Œprops å…·æœ‰ä¸å¯ä¿®æ”¹æ€§ã€‚å­ç»„ä»¶æƒ³æŠŠæ•°æ®ä¼ ç»™çˆ¶ç»„ä»¶æ€ä¹ˆåŠï¼Ÿé€šè¿‡ props ä¸­çš„äº‹ä»¶æ¥ä¼ å€¼é€šçŸ¥çˆ¶ç»„ä»¶</p>
<p>ä»“åº“åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://github.com/johanazhu/jo-redux">https://github.com/johanazhu/jo-redux</a></p>
</div><div class="tags"><a href="/tags/%E6%89%8B%E5%86%99/"><i class="fa fa-tag"></i>æ‰‹å†™</a><a href="/tags/redux/"><i class="fa fa-tag"></i>redux</a><a href="/tags/%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/"><i class="fa fa-tag"></i>çŠ¶æ€ç®¡ç†</a></div><div class="post-nav"><a class="pre" href="/2021/12/09/2021-12-09-%E6%90%9E%E8%BD%AE%E5%AD%90%EF%BC%9ATabBar%E6%A0%87%E7%AD%BE%E6%A0%8F%E7%9A%84%E8%87%AA%E6%95%91/">æè½®å­ï¼šTabBaræ ‡ç­¾æ çš„è‡ªæ•‘</a><a class="next" href="/2021/12/02/2021-12-02-%E4%B8%89%E5%8F%A5%E8%AF%9D%E6%B5%8B%E8%AF%95%E4%BD%A0%E6%98%AF%E5%90%A6%E6%87%82git/">ä¸‰å¥è¯æµ‹è¯•ä½ æ˜¯å¦æ‡‚git</a></div><div id="container"></div><link rel="stylesheet" type="text/css" href="//unpkg.com/gitalk/dist/gitalk.css"><script type="text/javascript" src="//cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js"></script><script type="text/javascript" src="//unpkg.com/gitalk/dist/gitalk.min.js"></script><script>var gitalk = new Gitalk({
  clientID: 'ff0c33d53db26a5b1424',
  clientSecret: 'd42b8e0556a1f4e20667e0a48c1adb9eca12d6ee',
  repo: 'blog',
  owner: 'johanazhu',
  admin: ['johanazhu'],
  id: md5(location.pathname),
  distractionFreeMode: false
})
gitalk.render('container')
</script></div></div></div><div id="secondary"><div class="widget"><div class="widget-title"><h3> æˆ‘çš„å¾®ä¿¡å…¬ä¼—å·</h3></div><div class="wechatwidget"><a href="#"><img src="https://s2.loli.net/2022/03/25/VqfD2ScLuKzjbR8.jpg"/></a><span>å¾®ä¿¡å·ï¼šjohanbo88</span></div></div><div class="widget"><div class="widget-title"><h3>æœ€è¿‘æ–‡ç« </h3></div><ul class="widget-list"><li class="widget-list-item"><a class="widget-list-link" href="/2024/07/31/2024-07-31-%E9%9D%A2%E8%AF%95%E4%B8%A4%E6%9C%88%E5%90%8E%E6%88%91%E5%8F%91%E7%8E%B0%E6%88%91%E8%BA%AB%E4%B8%8A%E7%9A%84%E9%97%AE%E9%A2%98/">é¢è¯•ä¸¤æœˆåæˆ‘å‘ç°æˆ‘èº«ä¸Šå­˜åœ¨çš„é—®é¢˜</a></li><li class="widget-list-item"><a class="widget-list-link" href="/2023/08/06/2023-08-06-%E5%B1%80%E5%9F%9F%E7%BD%91%E8%AE%BE%E5%A4%87%E8%AE%BF%E9%97%AEWSL%E9%A1%B9%E7%9B%AE/">å±€åŸŸç½‘è®¾å¤‡è®¿é—®WSLé¡¹ç›®</a></li><li class="widget-list-item"><a class="widget-list-link" href="/2023/07/26/2023-07-26-%E7%8E%B0%E4%BB%A3SEO%E8%AF%A5%E5%81%9A%E4%BA%9B%E4%BB%80%E4%B9%88/">ç°ä»£SEOè¯¥åšäº›ä»€ä¹ˆ</a></li><li class="widget-list-item"><a class="widget-list-link" href="/2023/06/21/2023-06-21-%E6%88%91%E7%9A%84%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%88%9D%E5%A7%8B%E5%8C%96%E5%81%9A%E5%93%AA%E4%BA%9B/">æˆ‘çš„äº‘æœåŠ¡å™¨åˆå§‹åŒ–åšå“ªäº›ï¼ˆæŒç»­æ›´æ–°ï¼‰</a></li><li class="widget-list-item"><a class="widget-list-link" href="/2023/05/22/2023-05-22-Vite+React+TypeScript%20%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/">Vite + React + TypeScript æœ€ä½³å®è·µï¼ˆ2023ï¼‰</a></li></ul></div><div class="widget"><div class="widget-title"><h3> åˆ†ç±»</h3></div><ul class="widget-list"><li class="widget-list-item"><a class="widget-list-link" href="/categories/10X%E7%A8%8B%E5%BA%8F%E5%91%98/">10Xç¨‹åºå‘˜</a><span class="widget-list-count">4</span></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/HTTP/">HTTP</a><span class="widget-list-count">2</span></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E5%89%8D%E7%AB%AF/">å‰ç«¯</a><span class="widget-list-count">1</span></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/">å‰ç«¯å¼€å‘</a><span class="widget-list-count">35</span><ul class="widget-list-child"><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/CSS/">CSS</a><span class="widget-list-count">6</span></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/JavaScript/">JavaScript</a><span class="widget-list-count">9</span></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/React/">React</a><span class="widget-list-count">12</span></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/umi/">umi</a><span class="widget-list-count">1</span></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/%E5%BC%80%E5%8F%91/">å¼€å‘</a><span class="widget-list-count">1</span></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/%E5%BE%AE%E4%BF%A1/">å¾®ä¿¡</a><span class="widget-list-count">3</span></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/">æ€§èƒ½ä¼˜åŒ–</a><span class="widget-list-count">1</span></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/%E7%A7%BB%E5%8A%A8%E7%AB%AF/">ç§»åŠ¨ç«¯</a><span class="widget-list-count">2</span></li></ul></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E5%AE%9E%E6%88%98/">å®æˆ˜</a><span class="widget-list-count">5</span><ul class="widget-list-child"><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E5%AE%9E%E6%88%98/%E5%85%AC%E5%8F%B8%E9%A1%B9%E7%9B%AE/">å…¬å¸é¡¹ç›®</a><span class="widget-list-count">3</span></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E5%AE%9E%E6%88%98/%E7%8B%AC%E7%AB%8B%E9%A1%B9%E7%9B%AE/">ç‹¬ç«‹é¡¹ç›®</a><span class="widget-list-count">2</span></li></ul></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E5%BA%93/">åº“</a><span class="widget-list-count">1</span></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E5%BC%80%E5%8F%91%E4%BD%93%E9%AA%8C/">å¼€å‘ä½“éªŒ</a><span class="widget-list-count">1</span></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/">å¼€å‘ç¯å¢ƒ</a><span class="widget-list-count">1</span></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E5%BE%AE%E4%BF%A1/">å¾®ä¿¡</a><span class="widget-list-count">1</span></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E6%9C%89%E7%9F%A5%E6%9C%89%E8%A1%8C/">æœ‰çŸ¥æœ‰è¡Œ</a><span class="widget-list-count">8</span><ul class="widget-list-child"><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E6%9C%89%E7%9F%A5%E6%9C%89%E8%A1%8C/%E5%86%99%E4%BD%9C/">å†™ä½œ</a><span class="widget-list-count">1</span></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E6%9C%89%E7%9F%A5%E6%9C%89%E8%A1%8C/%E5%88%86%E4%BA%AB/">åˆ†äº«</a><span class="widget-list-count">4</span></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E6%9C%89%E7%9F%A5%E6%9C%89%E8%A1%8C/%E5%AD%A6%E4%B9%A0/">å­¦ä¹ </a><span class="widget-list-count">3</span></li></ul></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/">æœåŠ¡å™¨</a><span class="widget-list-count">1</span></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%BC%80%E5%8F%91/">æœåŠ¡ç«¯å¼€å‘</a><span class="widget-list-count">9</span><ul class="widget-list-child"><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%BC%80%E5%8F%91/Koa2/">Koa2</a><span class="widget-list-count">3</span></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%BC%80%E5%8F%91/Node/">Node</a><span class="widget-list-count">2</span></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%BC%80%E5%8F%91/%E9%83%A8%E7%BD%B2/">éƒ¨ç½²</a><span class="widget-list-count">4</span></li></ul></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E7%90%86%E8%B4%A2/">ç†è´¢</a><span class="widget-list-count">1</span><ul class="widget-list-child"><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E7%90%86%E8%B4%A2/%E5%8A%A0%E5%AF%86%E8%B4%A7%E5%B8%81/">åŠ å¯†è´§å¸</a><span class="widget-list-count">1</span></li></ul></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87/">ç–‘éš¾æ‚ç—‡</a><span class="widget-list-count">2</span></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E7%A2%8E%E7%9A%AE%E6%89%AF%E6%B7%A1/">ç¢çš®æ‰¯æ·¡</a><span class="widget-list-count">2</span></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E7%A8%8B%E5%BA%8F%E5%91%98/">ç¨‹åºå‘˜</a><span class="widget-list-count">1</span></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">ç¼–ç¨‹è¯­è¨€</a><span class="widget-list-count">8</span><ul class="widget-list-child"><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Git/">Git</a><span class="widget-list-count">3</span></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/JavaScript/">JavaScript</a><span class="widget-list-count">5</span></li></ul></li><li class="widget-list-item"><a class="widget-list-link" href="/categories/%E8%BF%90%E7%BB%B4/">è¿ç»´</a><span class="widget-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><h3> å½’æ¡£</h3></div><ul class="widget-list"><li class="widget-list-item"><a class="widget-list-link" href="/archives/2024/07/">2024å¹´ä¸ƒæœˆ</a><span class="widget-list-count">1</span></li><li class="widget-list-item"><a class="widget-list-link" href="/archives/2023/08/">2023å¹´å…«æœˆ</a><span class="widget-list-count">1</span></li><li class="widget-list-item"><a class="widget-list-link" href="/archives/2023/07/">2023å¹´ä¸ƒæœˆ</a><span class="widget-list-count">1</span></li><li class="widget-list-item"><a class="widget-list-link" href="/archives/2023/06/">2023å¹´å…­æœˆ</a><span class="widget-list-count">1</span></li><li class="widget-list-item"><a class="widget-list-link" href="/archives/2023/05/">2023å¹´äº”æœˆ</a><span class="widget-list-count">1</span></li><li class="widget-list-item"><a class="widget-list-link" href="/archives/2023/04/">2023å¹´å››æœˆ</a><span class="widget-list-count">1</span></li><li class="widget-list-item"><a class="widget-list-link" href="/archives/2023/03/">2023å¹´ä¸‰æœˆ</a><span class="widget-list-count">2</span></li><li class="widget-list-item"><a class="widget-list-link" href="/archives/2023/02/">2023å¹´äºŒæœˆ</a><span class="widget-list-count">1</span></li><li class="widget-list-item"><a class="widget-list-link" href="/archives/2023/01/">2023å¹´ä¸€æœˆ</a><span class="widget-list-count">1</span></li><li class="widget-list-item"><a class="widget-list-link" href="/archives/2022/12/">2022å¹´åäºŒæœˆ</a><span class="widget-list-count">1</span></li><li class="widget-list-item"><a class="widget-list-link" href="/archives/2022/10/">2022å¹´åæœˆ</a><span class="widget-list-count">1</span></li><li class="widget-list-item"><a class="widget-list-link" href="/archives/2022/09/">2022å¹´ä¹æœˆ</a><span class="widget-list-count">1</span></li><li class="widget-list-item"><a class="widget-list-link" href="/archives/2022/08/">2022å¹´å…«æœˆ</a><span class="widget-list-count">1</span></li><li class="widget-list-item"><a class="widget-list-link" href="/archives/2022/07/">2022å¹´ä¸ƒæœˆ</a><span class="widget-list-count">2</span></li><li class="widget-list-item"><a class="widget-list-link" href="/archives/2022/05/">2022å¹´äº”æœˆ</a><span class="widget-list-count">2</span></li><li class="widget-list-item"><a class="widget-list-link" href="/archives/2022/04/">2022å¹´å››æœˆ</a><span class="widget-list-count">4</span></li><li class="widget-list-item"><a class="widget-list-link" href="/archives/2022/03/">2022å¹´ä¸‰æœˆ</a><span class="widget-list-count">7</span></li><li class="widget-list-item"><a class="widget-list-link" href="/archives/2022/02/">2022å¹´äºŒæœˆ</a><span class="widget-list-count">8</span></li><li class="widget-list-item"><a class="widget-list-link" href="/archives/2022/01/">2022å¹´ä¸€æœˆ</a><span class="widget-list-count">5</span></li><li class="widget-list-item"><a class="widget-list-link" href="/archives/2021/12/">2021å¹´åäºŒæœˆ</a><span class="widget-list-count">8</span></li><li class="widget-list-item"><a class="widget-list-link" href="/archives/2021/11/">2021å¹´åä¸€æœˆ</a><span class="widget-list-count">8</span></li><li class="widget-list-item"><a class="widget-list-link" href="/archives/2021/10/">2021å¹´åæœˆ</a><span class="widget-list-count">5</span></li><li class="widget-list-item"><a class="widget-list-link" href="/archives/2021/09/">2021å¹´ä¹æœˆ</a><span class="widget-list-count">5</span></li><li class="widget-list-item"><a class="widget-list-link" href="/archives/2021/08/">2021å¹´å…«æœˆ</a><span class="widget-list-count">8</span></li><li class="widget-list-item"><a class="widget-list-link" href="/archives/2021/05/">2021å¹´äº”æœˆ</a><span class="widget-list-count">1</span></li><li class="widget-list-item"><a class="widget-list-link" href="/archives/2021/04/">2021å¹´å››æœˆ</a><span class="widget-list-count">2</span></li><li class="widget-list-item"><a class="widget-list-link" href="/archives/2021/02/">2021å¹´äºŒæœˆ</a><span class="widget-list-count">1</span></li><li class="widget-list-item"><a class="widget-list-link" href="/archives/2020/11/">2020å¹´åä¸€æœˆ</a><span class="widget-list-count">3</span></li></ul></div><div class="widget"><div class="widget-title"><h3>å‹æƒ…é“¾æ¥</h3></div><ul></ul><a href="https://azhubaby.com/" title="ä¸ªäººç½‘ç«™" target="_blank">ä¸ªäººç½‘ç«™</a><ul></ul><a href="https://fe.azhubaby.com/" title="äº”å¹´å‰ç«¯ä¸‰å¹´é¢è¯•" target="_blank">äº”å¹´å‰ç«¯ä¸‰å¹´é¢è¯•</a></div></div></div></div></div><footer id="footer"><div class="container"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>Â© 2024 <span>æœ¬ç«™æ€»è®¿é—®é‡ï¼š<span id="busuanzi_value_site_pv"></span>&nbsp;æ¬¡</span>
<span>æ€»è®¿å®¢ï¼š<span id="busuanzi_value_site_uv"></span>äºº</span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo. &nbsp;</a>Theme by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></footer><link rel="stylesheet" type="text/css" href="/css/search.css?v=1.0.2"><script type="text/javascript" src="/js/search.js?v=1.0.2"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'search-input', 'search-results');
</script><script type="text/javascript" src="/js/copycode.js" successtext="å¤åˆ¶æˆåŠŸï¼"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.2"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.2"></script><div class="search-page"><div class="search-icon-close-container"><span class="search-icon-close"><i class="fa fa-chevron-down"></i></span></div><div class="search-main container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><form></form><input type="text" id="search-input" placeholder="searching..."><div class="mini-post-list" id="search-results"></div></div></div></div></div></body></html>